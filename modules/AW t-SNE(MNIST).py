#
#  tsne.py
#
# Implementation of t-SNE in Python. The implementation was tested on Python
# 2.7.10, and it requires a working installation of NumPy. The implementation
# comes with an example on the MNIST dataset. In order to plot the
# results of this example, a working installation of matplotlib is required.
#
# The example can be run by executing: `ipython tsne.py`
#
#
#  Created by Laurens van der Maaten on 20-12-08.
#  Copyright (c) 2008 Tilburg University. All rights reserved.

import numpy as np
import pylab
from sklearn import datasets
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import recall_score,precision_score,f1_score
from sklearn.neighbors import KNeighborsClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay
from sklearn.naive_bayes import GaussianNB

###svd(2000data49)
# weight=[0.07966853963647261, 0.028626452571265743, 0.02339542932789175, 0.018379564253476182, 0.017205396994317775, 0.015974497672582095, 0.01425565477293088, 0.014062241314703142, 0.013744814510882768, 0.012379491972756741, 0.011816787621489576, 0.011094170529529941, 0.01098194850137938, 0.010523844847096486, 0.009564100762563473, 0.008948134822121737, 0.008549111790783754, 0.00841321832043638, 0.008070528568774358, 0.007865840232557259, 0.007655852388069108, 0.0075525186010303525, 0.007312829856976532, 0.007173986196510737, 0.006968608995669891, 0.006745356466241392, 0.006557320760517667, 0.006469342328724746, 0.00609448430445115, 0.006028073146967629, 0.005994845491453396, 0.005821986410268789, 0.005764793645066368, 0.005547153219485202, 0.005466938259021046, 0.005355104156946052, 0.005204754972935032, 0.005165467882419759, 0.005116060202912574, 0.0049686266839012215, 0.004877420528248218, 0.004721086299745925, 0.00467432464888555, 0.004640937092233727, 0.004466881689707543, 0.004387166808635952, 0.004356893110516683, 0.004273013482235701, 0.004192179208787251, 0.00407555128328761, 0.004039634631826658, 0.003967260811010525, 0.0039047988698158076, 0.003875803875942439, 0.003817092047643142, 0.003796350009878022, 0.0037470313741518103, 0.0036766481931863612, 0.0035942875660695613, 0.0035864104051569995, 0.003515782006402015, 0.0034878533061353605, 0.0034668709496176037, 0.0034316591836357994, 0.003353150664493983, 0.003296326240455497, 0.0032860656811277322, 0.003242637130848636, 0.0031974223530667123, 0.0031372220689224427, 0.0030812465877939825, 0.003061491743357516, 0.0030238563372922056, 0.0030048655510101566, 0.002971014502577747, 0.002942288882463663, 0.0028985254810938357, 0.00286399701885171, 0.002837090822898417, 0.0027820189829026168, 0.0027696005207081425, 0.0027586633040111806, 0.0027433555708765768, 0.00266963764145413, 0.0026588769152582083, 0.002645706685659772, 0.0026167343063286407, 0.0026128086003635886, 0.0025796479111794175, 0.0025747254549971376, 0.002508896945648681, 0.0024909517563430636, 0.0024729062845967654, 0.0024509113284904072, 0.002424041972606517, 0.0024097383442530916, 0.00238732410797507, 0.002359264069078695, 0.0023420715066260057, 0.00233212409448859, 0.0022977543084719246, 0.0022881972167817155, 0.002272505134259773, 0.002242692934453396, 0.0022231812046627085, 0.0022114131670567675, 0.0021916864525982132, 0.002187601523817652, 0.002164410939984352, 0.002157140119354881, 0.0021380961803255496, 0.0021223285699918625, 0.002117570119118476, 0.0020872394380384474, 0.0020743940843669186, 0.002051699173278478, 0.0020350883595129207, 0.0020104642742277325, 0.001998177619937349, 0.0019954338814743957, 0.0019743920519754913, 0.00195939026329736, 0.0019427130858893544, 0.0019318523636537484, 0.0019191851782100898, 0.0019067732597280503, 0.0019022978709113826, 0.001896597898750134, 0.001876621146737649, 0.001868610613941257, 0.0018519959137614438, 0.0018352597236029177, 0.0018238833808198408, 0.0018122985349649419, 0.001795355225506085, 0.0017810778059720465, 0.0017744725111101083, 0.0017605812050312411, 0.0017565393915539324, 0.0017400105067176357, 0.0017191816004599176, 0.0017071949369268649, 0.0016986904489216447, 0.0016904476325493502, 0.0016825072314479957, 0.0016688301246944428, 0.0016662103166602141, 0.0016570076514289456, 0.0016404602848465897, 0.0016263755280311076, 0.0016184449303089943, 0.0016101000337528557, 0.001597032251855758, 0.0015882557544640474, 0.0015768342129165909, 0.0015698427041266317, 0.001557812949291994, 0.001550111912173728, 0.001546077820329096, 0.0015199719261692465, 0.001517297926419686, 0.0015111951388999143, 0.0014990100196781533, 0.001487569689859385, 0.001482580692202161, 0.0014787033524480456, 0.0014745196116356292, 0.001463225781377223, 0.0014577936253265104, 0.001456261098008976, 0.001442531609801233, 0.0014308516513328849, 0.0014246430496563161, 0.0014176743365228034, 0.001406439516854284, 0.001401441086660035, 0.0013954701292154634, 0.0013814393644899137, 0.0013749167630058387, 0.0013642087936701927, 0.001360513346379529, 0.0013509826025811678, 0.0013463823323957272, 0.00134323304170161, 0.0013340333301301304, 0.0013301944151641444, 0.001318599540812888, 0.0013117635315364664, 0.0013051629846039174, 0.0012956043237327452, 0.0012893113165179072, 0.0012829830986969858, 0.001280901259354125, 0.0012738224530083528, 0.0012651534684727747, 0.0012589359073894972, 0.0012553621680497617, 0.0012452891286008146, 0.00123662312214752, 0.0012318683811999122, 0.0012261435034932044, 0.0012193632912951822, 0.0012138220352742178, 0.001208178138142471, 0.0012019520814324585, 0.0011978019565812034, 0.0011870103094101473, 0.001184093983578015, 0.0011740446070404912, 0.0011684713348620497, 0.0011655692024266939, 0.001155806565964156, 0.0011534284885252133, 0.0011517833591196897, 0.001145868954039598, 0.001138855581196559, 0.0011329959709796328, 0.0011318155471628573, 0.0011188299628677686, 0.0011154286498205371, 0.0011092452261140203, 0.0011074537367748198, 0.0011023025577567556, 0.0010957383567550682, 0.0010920710580061182, 0.0010864642526471951, 0.0010774884477700072, 0.001073179192507469, 0.0010709769378420976, 0.0010656965953001047, 0.0010594517459570133, 0.0010534399272258703, 0.0010502062496944606, 0.0010428797581836353, 0.0010347716643212949, 0.001030503050382689, 0.0010269032303445434, 0.0010229566505080307, 0.0010193654514174522, 0.0010167728324044362, 0.0010117430616095552, 0.0010056237346965534, 0.0010016139097716779, 0.000992676304035307, 0.000992071889431746, 0.0009811269155763657, 0.0009780628705324428, 0.0009739494153223378, 0.0009682401306341547, 0.0009629245857130103, 0.0009543903481222176, 0.0009510419712959119, 0.0009487058906554347, 0.0009446065067940432, 0.000942490989528995, 0.0009362582757488637, 0.0009339808281303293, 0.0009290167045365689, 0.0009246519973090179, 0.0009171259160725925, 0.0009144135063282174, 0.0009104246618301368, 0.0009092575150289293, 0.0009058599512089062, 0.0008985768019474569, 0.0008912414178944047, 0.0008867080311416603, 0.0008826499363419545, 0.0008808282026391918, 0.0008765185322500467, 0.0008722968358002642, 0.0008705422326871265, 0.0008647393464897091, 0.0008593138347576278, 0.0008580480805199303, 0.0008533446617898647, 0.0008463631993007917, 0.0008424091133964574, 0.0008399174362292309, 0.0008356102997547032, 0.0008284796815974435, 0.0008219656282820767, 0.0008197016400906695, 0.000818848130123177, 0.0008122725295543428, 0.0008086793587898535, 0.0008036981291975269, 0.0008018999023814545, 0.0007961371748988343, 0.0007871566345410472, 0.0007830549552306713, 0.0007802549420360087, 0.0007780657898077524, 0.0007723462899475638, 0.000765367800405944, 0.0007631686110950842, 0.0007582757557609989, 0.0007562274502717476, 0.0007536422368860337, 0.0007504091909390946, 0.0007457928141053339, 0.0007422597570467765, 0.0007363969844589301, 0.0007327660804832584, 0.0007312363812746844, 0.0007262925494995275, 0.0007238559618668931, 0.0007218953444469115, 0.0007197944355648318, 0.0007133911031875415, 0.0007103715329131706, 0.0007081292528777673, 0.0007060015125046996, 0.000699759582838905, 0.0006960587761702922, 0.0006927973219163303, 0.0006911793813042194, 0.000684796041642617, 0.0006807526560754766, 0.0006753761499889522, 0.0006739055310468544, 0.000669984790704422, 0.0006681065154913363, 0.0006657883520029531, 0.0006605615401981526, 0.0006533629298791249, 0.0006460251317082944, 0.0006439609755367923, 0.0006414418486308375, 0.0006388703852299595, 0.0006338176983185863, 0.0006305927341552749, 0.0006267354367797834, 0.0006214111276610292, 0.0006186254348036086, 0.0006138276711333353, 0.0006099798051204028, 0.0006085137310710596, 0.0005986620077342296, 0.0005937490805218494, 0.0005918740419087942, 0.000589015230051679, 0.0005869416262272302, 0.0005798277785551199, 0.00057875945707857, 0.0005757970228118449, 0.0005717257321104695, 0.0005673346301241515, 0.0005641048503389758, 0.0005615156321248289, 0.0005577915759917635, 0.000553410516568338, 0.0005479049111281271, 0.000543208204559899, 0.0005410226910248779, 0.0005351245942633774, 0.0005329513057817713, 0.0005285163066593692, 0.0005236502845377612, 0.0005203300515025995, 0.0005175557583378496, 0.0005135905153197053, 0.0005122617262702944, 0.0005030888544924893, 0.0005006161120441819, 0.0004979867873196611, 0.0004946086339413875, 0.0004894046017782299, 0.0004887450987770399, 0.0004864994296633466, 0.00048394022714116, 0.0004826577365704793, 0.00047609459458887633, 0.00047181686873103525, 0.00046897912077136254, 0.00046504887526850684, 0.00045823270991596465, 0.00045648763037695896, 0.000453445471955155, 0.00044847514105575496, 0.0004456840618067667, 0.00044010603265200274, 0.00043819536963680267, 0.00043659182289031764, 0.0004337404511686138, 0.00043173502155694697, 0.00042607989614770763, 0.00041967203588295693, 0.0004186814956729882, 0.00041720366039227813, 0.0004110420877379119, 0.0004082571827167806, 0.0004034998202569901, 0.00040141204065938615, 0.00039931190659998536, 0.0003934833256742001, 0.00039037715408854424, 0.0003883314310194243, 0.0003841924750839375, 0.0003831373201029822, 0.00037640123858388497, 0.0003738007232286284, 0.0003719881634570097, 0.00036880865406561486, 0.0003665701114335971, 0.00036479905180035693, 0.00036023435273914054, 0.00035980214778991507, 0.00035480658081130193, 0.0003505467314897383, 0.0003482216250344877, 0.0003439734724531672, 0.0003405299824513831, 0.00033799890720083745, 0.000335602717399232, 0.0003333386918911287, 0.00032896597795363557, 0.0003272751589344719, 0.00032438542869877494, 0.0003207355417753522, 0.00031914499789195564, 0.00031516345301410494, 0.00031247962324382536, 0.0003101578104285131, 0.00030974778045900566, 0.00030641732516904617, 0.0003016156343593809, 0.0002993035914647782, 0.0002967604703003535, 0.00029410970522028676, 0.0002904205186140236, 0.0002855828658354239, 0.0002835438116475325, 0.00028294891584460766, 0.00028080058931854925, 0.0002747171115273057, 0.0002724729627241074, 0.0002711939483483655, 0.00026881573169902374, 0.00026504977861585354, 0.0002628924747887025, 0.00026100428185821186, 0.0002571682796379438, 0.00025574759551572665, 0.0002525293926880877, 0.0002486962353421019, 0.00024777840530262624, 0.0002434378178597935, 0.00024194755484079644, 0.00023895409700580824, 0.00023635837454501164, 0.00023333028376880768, 0.00023116207493068962, 0.00022843548485630065, 0.00022550022083128927, 0.00022194473920329717, 0.00021893162796519016, 0.00021785771649916248, 0.00021377949451104045, 0.00021093023988927485, 0.00020768171467836638, 0.00020441860700000708, 0.00020357280849172545, 0.0002020007341584404, 0.0001990283146511185, 0.00019829688464308439, 0.0001956091192988708, 0.0001953909067200166, 0.00018925027132173298, 0.00018880541007151822, 0.00018674725880722881, 0.0001846847426427577, 0.00018254860778964672, 0.0001788709135156867, 0.00017613808680137403, 0.00017061307643464777, 0.00016828395525785088, 0.00016538292211751068, 0.0001640019856970727, 0.00016228370734390452, 0.00015922478578120114, 0.00015612700345093484, 0.0001537680992451056, 0.00015147043516102767, 0.00014816976976118396, 0.00014642948365108208, 0.00014346293115805736, 0.00014081692167750782, 0.00013875846957562798, 0.00013565638981037002, 0.00013495008943640297, 0.00012898399879921862, 0.00012727158481705127, 0.00012562377668261061, 0.00012306918816389702, 0.000117201890559653, 0.0001161209771401646, 0.00011270970721750481, 0.00011046137353323144, 0.0001090378083395773, 0.00010807797074415421, 0.00010458240791235768, 0.00010437690007148508, 9.752060365332118e-05, 9.583785637078804e-05, 9.162196179192923e-05, 9.018203152950418e-05, 8.764994003924158e-05, 8.626498695281269e-05, 8.207173670497622e-05, 8.082146802896864e-05, 8.022265304484211e-05, 7.600425900041653e-05, 7.382753046258859e-05, 7.197227164096684e-05, 6.949628904296225e-05, 6.817798382938621e-05, 6.678823840508762e-05, 6.654921372799777e-05, 6.499082681695636e-05, 6.204455367912154e-05, 6.057537141976774e-05, 5.773648505885045e-05, 5.4618019608642405e-05, 5.359033846631033e-05, 4.972026068949732e-05, 4.896253190822402e-05, 4.734290391600101e-05, 4.535716801320583e-05, 4.426826492534833e-05, 4.325965160052525e-05, 4.110618341641545e-05, 3.980544872110362e-05, 3.8822450056781016e-05, 3.5267935450868344e-05, 3.4253141551830145e-05, 3.422090642767838e-05, 3.3277325394390333e-05, 2.9145122939400308e-05, 2.8136671624572122e-05, 2.7338897647656965e-05, 2.453663625710524e-05, 2.1761777495382248e-05, 1.720305720477553e-05, 1.711175443826618e-05, 1.4992141192834039e-05, 1.393263081691864e-05, 1.25954981871195e-05, 8.60822021499889e-06, 7.942593301845554e-06, 5.422351323584729e-06, 4.862992047610583e-06, 4.752979426777074e-06, 4.544616350321782e-06, 2.3679829839481676e-06, 3.6558229669159515e-17, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 6.343945911419185e-18, 5.47629131830433e-18, 3.567208330965707e-28]
###pso(2000data49)
# weight=[0.06582496188363939, 0.014711607625623709, 0.005125674668031077, 0.003966872268584945, 0.004386719112239519, 0.009559527319000042, 0.008455319440400266, 0.003642483532019993, 0.004187859208561344, 0.004776781343712724, 0.006163060915052585, 0.003274105015547779, 0.006564483084475498, 0.00391309681321079, 0.005404802638191386, 0.005647291207957812, 0.005051063689397007, 0.004654212520950272, 0.0020920922513608157, 0.0034680036283224664, 0.004006331020903499, 0.002810767424850168, 0.0025421382972427345, 0.0030114127608668727, 0.002061226775330936, 0.00268246605932618, 0.0024934582723894344, 0.0033795687735318765, 0.004344729834257972, 0.0034087816297050104, 0.003779739017489513, 0.0022452951783314724, 0.0024562087213782792, 0.0024435515282304546, 0.0030448114337734613, 0.002399813936361796, 0.0017696713442380755, 0.0025758067309838645, 0.0031474329926660938, 0.001622697056180932, 0.0021366598245252683, 0.003696674936571363, 0.0022752268577839866, 0.0015000316441257013, 0.0017548362663750052, 0.0031045032243834096, 0.0027668702237277215, 0.0022886974214782413, 0.0022627307769865447, 0.0027127416209901086, 0.002120432861725341, 0.0027786775027772606, 0.0015814048828476234, 0.0019209085039663257, 0.0021336397567451857, 0.002297315609718927, 0.0019997479308198987, 0.002194865764765375, 0.002402599560444764, 0.002080463090533181, 0.0016804025521195754, 0.0019405951733286815, 0.002026970092274433, 0.0023884352054484403, 0.0018090430482453764, 0.001974470277467531, 0.0017856326620745264, 0.0018751282153068156, 0.0016046077888681688, 0.0016177744026601036, 0.0013700704462990682, 0.0019537224597697485, 0.0013351470397523731, 0.0015191762935109544, 0.00201768416585558, 0.0022624271346078726, 0.001795012597255342, 0.0018235565487413562, 0.001274722131750966, 0.0018581189279641569, 0.002053560021995814, 0.0018233793678145262, 0.0019728110465607905, 0.0014642906034846837, 0.001730985751559074, 0.0020343423366240973, 0.0016893818491331633, 0.001975493661646694, 0.002328989009785945, 0.0018570656402403605, 0.0017643475814481063, 0.0018988251157544534, 0.0014202743177760633, 0.0016302899147797585, 0.0018620867400092553, 0.0016575491352905525, 0.0016159065116960454, 0.0015965324286421148, 0.0014833062024136657, 0.0018214651051405057, 0.001393889987275139, 0.0016190844360314694, 0.0016116351357751539, 0.001671466960873005, 0.0013746231123344887, 0.0015661000976994214, 0.0014623399325989432, 0.0016086991239460755, 0.0017623922073426372, 0.0015562789604888429, 0.0015105878900214327, 0.0015713910272468214, 0.001395909880079999, 0.0015981644061061034, 0.0013134443394180546, 0.0013844117611019958, 0.001651393950055174, 0.0015746933382383653, 0.0016126606078303725, 0.001273763440679493, 0.0015680626614234879, 0.0014851256291074724, 0.0015124421424170227, 0.0016109275794675773, 0.0015866606302822844, 0.001559404998013988, 0.0031530650822315025, 0.0015519777523801597, 0.0013986686804033116, 0.0015097277957990176, 0.0015528418661191073, 0.0014296169758658236, 0.001553421545900496, 0.0013836243191560193, 0.0015449759853052901, 0.0013760494471264737, 0.001501145795351451, 0.0015155126997861482, 0.0015809345304167593, 0.0013388131292414109, 0.0014392154485235729, 0.0014374668323170834, 0.0014331540575339623, 0.0014145700743347018, 0.0013787883362769138, 0.0014668913515031255, 0.001373745584733265, 0.001416908354818772, 0.0013306281408836545, 0.001322148497655547, 0.0013621911958985383, 0.0014079852894191027, 0.0013723852243036707, 0.0014286189154618953, 0.0014290830401462585, 0.0014116451264242148, 0.00117896561387524, 0.0014035456669564195, 0.001370062778081585, 0.0014010798040780972, 0.0013437546361177966, 0.0013775044413911108, 0.0013723541735775442, 0.0013368417081099458, 0.001290762137761365, 0.001367235681983001, 0.0013495284937678161, 0.0013462599340396016, 0.0013810788127254663, 0.0013564810552925627, 0.001310416950337946, 0.0013239786544963757, 0.0013232179960756033, 0.0013351104312197858, 0.001230299552373587, 0.0012926110076019067, 0.0013154879792030437, 0.0013008982058357861, 0.001308747509582566, 0.001299663534013785, 0.0013058175102754648, 0.0012973758954179459, 0.0009831284145471486, 0.001279626639704036, 0.0012797208561162248, 0.0012826432565291185, 0.0012860553883369292, 0.0012602377147304853, 0.0012920642573590758, 0.0012718247833103536, 0.0012787745248959185, 0.0012744172491985543, 0.0012664108982862275, 0.0012623503312171617, 0.0012686814260900491, 0.0012515651542429895, 0.0012656034096338873, 0.0012675409680206055, 0.0012399829244921035, 0.0012602877594651656, 0.0012466494762987715, 0.001268619722229882, 0.0012293158379802112, 0.001231031511206327, 0.001238213485170443, 0.0012274654581182413, 0.00121788653223885, 0.0012584589523269116, 0.0012607448711516147, 0.0012464006726321134, 0.0012456055014673346, 0.0012047208413580993, 0.0011955737892251962, 0.0012163072036066682, 0.0012527246216202863, 0.0012118492489185456, 0.0012111047696148122, 0.0011934460405897346, 0.0011522500023779323, 0.001214734620620105, 0.0011865370197332067, 0.0012264721931074022, 0.0012406076245146884, 0.0011965476876597946, 0.0012005463641369092, 0.001162402432712129, 0.0011732927626235481, 0.0012541034067382014, 0.0012507417875688045, 0.0012405308659615534, 0.0012017363306939856, 0.0011826835768611807, 0.0011824023547719763, 0.001235955054291403, 0.0012195306879944669, 0.0011602275742930651, 0.0010890753056375583, 0.0011258544185543272, 0.0010496134429156057, 0.0011173203361362466, 0.0011391093333924223, 0.0011941434567534991, 0.0011212675784862953, 0.0011728886543254835, 0.0011313930658644338, 0.0011319298980025229, 0.0011084421363628857, 0.001147065528017885, 0.001162438814040103, 0.0011817574838224173, 0.0011746402843327076, 0.0011635217776246936, 0.0011111818881921855, 0.001137892818536926, 0.0012058385891806707, 0.0011303659908510665, 0.0012044853697584772, 0.0011925989228755269, 0.0010890551474536246, 0.0011663064029922665, 0.0011128340657650508, 0.0011290613675012983, 0.0012650639921988963, 0.0011708569316958265, 0.0010878058433566966, 0.0011287189673177256, 0.0011659532947022077, 0.0011290380150955012, 0.001197724291311527, 0.001161656416442085, 0.0011803341682174924, 0.0011378596550202817, 0.0011195743625474833, 0.0010962715694454376, 0.0011382836190026078, 0.0011480353058791286, 0.0010610646351768812, 0.0011776111912560803, 0.0011791425917428956, 0.0009853708322220649, 0.0011579307763159672, 0.0011000456205699403, 0.001127408722217598, 0.0011829188949580146, 0.0011079895290846038, 0.0010633413460711966, 0.0008945184243360149, 0.0010536707467500872, 0.0010892165617197548, 0.0011073021505778112, 0.0010054416453617835, 0.0010262889493163785, 0.0012394151444695028, 0.0011469667426562613, 0.0009927941816039545, 0.0007343126046589478, 0.0010204157711658736, 0.0010849051163019598, 0.0011675787692235432, 0.001042256273924824, 0.0010924232244787968, 0.0009593763321572654, 0.0002542820278466534, 0.0012283578127054357, 0.0011583634481897704, 0.001226635232883656, 0.001048509362910357, 0.001177338849439788, 0.0011504550828066935, 0.0012276533045731826, 0.001059876452008158, 0.0010674353424248815, 0.0010365346598457815, 0.0011522663929508193, 0.0010609726596557244, 0.0010988983334516865, 0.0008707073173388119, 0.0010602250002631202, 0.0010555783059378124, 0.001031660910047139, 0.000984172971826785, 0.0010079463672338564, 0.0011024517593320605, 0.000994910869076388, 0.0009296306356109873, 0.0008930046931315224, 0.001034623084373491, 0.0007629881802064146, 0.0011310817624582707, 0.0010157093474488872, 0.0009361608561667911, 0.0009334310090124889, 0.0010722944480701527, 0.0011223756278856956, 0.001190307851075996, 0.0010315943512176362, 0.0009681223715309326, 0.0011274670337241262, 0.0010937884110770184, 0.0011092579065418978, 0.0010118763911166181, 0.0009346194488931292, 0.0009789833524543137, 0.0003140328767019938, 0.0011304022176919892, 0.0011084926896155743, 0.0010558949456364393, 0.0005714771172304254, 0.0009702952244142869, 0.0010857741780140094, 0.0009816813258624415, 0.001125099288531525, 0.0010504299758250458, 0.0010728662416553878, 0.0010618828676822061, 0.0010805802272524688, 0.0008196469389233655, 0.001138377975123724, 0.0009447071210904104, 0.0008148492945460646, 0.0008530509880007158, 0.00097750040863433, 0.0009022930842310249, 0.0010700385731053582, 0.0009415115306297337, 0.0010833429946746627, 0.0008439835402195532, 0.001004713467553434, 0.000899779771537831, 0.0008627950217090798, 0.0010506644967592054, 0.0010439875986687887, 0.001135110318320903, 0.0009228459410989392, 0.0010536930355150935, 0.0009769832658170572, 0.0008071453271260262, 0.0008066051658821215, 0.0011558201761885994, 0.001161431343789232, 0.0008673498217874902, 0.0008506886772104981, 0.0011700130877116614, 0.000930597750536872, 0.0010245654577381456, 0.0009219498171648189, 0.0009536365596407613, 0.001224821277292204, 0.0009943917762598917, 0.0011861221761386466, 0.0010963614872584232, 0.0006876506497018196, 0.0009315713982063037, 0.0010303370676783415, 0.0007403422904586997, 0.0008790480763185652, 0.0008682670188238006, 0.0008404161302820343, 0.0009729727946726599, 0.0008745093736279922, 0.0008658604021534052, 0.0011734330672350044, 0.0009887069894270529, 0.0011515100757082878, 0.0012070233656360835, 0.0010551279631183575, 0.0009697816002516065, 0.0008225889492713621, 0.0008727947910107001, 0.0010210411776627045, 0.0009571997813348417, 0.0009259070797478817, 0.0011493304292602257, 0.0009986034991463087, 0.0011312073213691981, 0.0007822359568169347, 0.0008951471948304584, 0.0009921954648584226, 0.0009142516490309121, 0.0010878000802016469, 0.0006278742707245757, 0.000956358231889816, 0.000666686785691681, 0.0009024605449665312, 0.00087498191475413, 0.0011215232915218244, 0.0007413771052597486, 0.0008801649031903341, 0.0009924216686114733, 0.0008770816244331563, 0.0008890016394305092, 0.0007343787116357698, 0.0009424075116554927, 0.0009347421653970949, 0.001076668885321915, 0.0008868941541861229, 0.0008891758670431989, 0.0009984023748958145, 0.0007210367766184375, 0.0011112889226689668, 0.0011400907365869753, 0.0007661333227723295, 0.0010857500280969064, 0.0006875327880504186, 0.0008221860584572794, 0.0007944159079570333, 0.0008693634936303431, 0.0008712513345353631, 0.0008313822417440612, 0.001092833485486436, 0.0009481271433011691, 0.0009527848413604708, 0.0009601623215786248, 0.0008903450513860074, 0.0010437948386543606, 0.0009394539936162491, 0.0010894432648569663, 0.0008852673234725761, 0.000992520854669854, 0.0009839415406995454, 0.0009340297107186932, 0.00041856059471405893, 0.0009937350345468193, 0.0005946029365513834, 0.0011560335358116519, 0.0008933872718048518, 0.0009839190553972955, 0.0007564398332516565, 0.0007141249893166785, 0.0008743525130795336, 0.0007690403835660488, 0.0009930091149151236, 0.0008591421810461827, 0.0009771754050351303, 0.0009399906718585138, 0.0005790352285138156, 0.0006764093002861583, 0.0009238272933534377, 0.0006834469385354047, 0.0007076029600643257, 0.0010080894168850239, 0.0007124813791920304, 0.0008259177550592018, 0.0011101454059876843, 0.0006652045055279698, 0.0008897289067560895, 0.0005589380673133698, 0.000966379312077259, 0.000873090394480426, 0.0008489060090816271, 0.0009466489479435598, 0.0009582729424540006, 0.000620510170314592, 0.0008408530101045528, 0.0004498315769182905, 0.0011091988625312067, 0.0007544334668253236, 0.0008107826406184047, 0.0008136686237382217, 0.0008145432685046534, 0.000844794328822984, 0.0006796269563275993, 0.0007697701245903586, 0.0008138148261968612, 0.0007061728997185984, 0.0006722757429715252, 0.0006878632886934565, 0.0007483771449709394, 0.0006839735969473353, 0.0007565886276864923, 0.0007686080555925237, 0.0008244113811177881, 0.0008928238165612979, 0.0007926464208858005, 0.0009665436293849554, 0.0008904368523286869, 0.0008983541616125827, 0.00037435936071261483, 0.0007312230693472516, 0.0007328155619773082, 0.0007262174325077719, 0.0007320191648832569, 0.0009362186144044687, 0.0009230346555690852, 0.0009396660952295787, 0.0008010966554302809, 0.0011989333106301517, 0.000922776000890276, 0.0008011145610584899, 0.0010020250710371574, 0.0010149978751110072, 0.0009828012026865186, 0.0003896598807193019, 0.0007240005348645784, 0.0007245831849312958, 0.0007762033377016383, 0.0005661823039948291, 0.0005595365784823778, 0.0009603045361538894, 0.0008413361332589666, 0.0009633605650939416, 0.0007044158450022015, 0.0007734094015995203, 0.0007504460996918821, 0.0007534303805409202, 0.0005191110271543998, 0.0009746563096240045, 0.001055460068486039, 0.000493096740788313, 0.001188626009789014, 0.0007311588313482873, 0.0006371295700041565, 0.0008969165785703284, 0.0007428089538626072, 0.0006392468118915015, 0.000351380182644441, 0.0010172051770530408, 0.0008168601776199971, 3.765496951447224e-05, 0.0005768086001258752, 0.00043274578647449415, 0.0009698642136301439, 0.0006904580617816696, 0.0007209414387720895, 0.0006637621916401703, 0.0006687321819690952, 0.001188989791868802, 0.0007884941685484862, 0.0007173671226235987, 0.0005169381343754825, 0.0007172565359867693, 0.0004868099566409893, 0.0007575258944641043, 0.0006167811448860499, 0.0007768224409476608, 0.0007278454375710086, 0.0009342786953292555, 0.0010981198674825101, 0.0007233414056626227, 0.0007265698747453072, -0.00011020044022513477, 0.0007961065420709128, 0.0006859803427603426, 0.0010881661355719443, 0.0007756944258654788, 0.0006045505435759688, 0.0006578743216489836, 0.0003429225643118606, 0.0002811929513398687, 0.0006665411594919715, 0.0009422361641119467, 0.001010355328713734, 0.0007930259356781575, 0.0009248693605856145, 0.0008119018676935243, 0.000757044637415728, 0.0006633076680105888, 0.0010807997841659586, 0.0002805354503980506, 0.0008180703505530661, 0.0009319644803409612, 0.000894098173651545, 0.0006750421429257687, 0.0008005060925699768, 0.001110282894247159, 0.0011177404663469876, 0.0008412490763031964, 0.0008304348861464116, 0.0005553653988353722, 0.0008873332415908152, 0.0008362492649160517, 0.0008107948008507353, 0.0006506996197076424, 0.0008105191936702328, 0.0009312604620677241, 0.0011195197234425021, 0.000985327118733919, 0.0007913573834920401, 0.0005676961572931288, 0.0008846697828401093, 0.0010774427844887217, 0.0008330990890290447, 0.0009790177763617188, 0.0006471591058480711, 0.0006644198454399368, 0.0008514757861046613, 0.000999913121624545, 0.0004934801822089691, 0.0010580643137051116, 0.0005596895925719362, 0.000530470006568135, 0.0006762702921104956, 0.0010192630462840554, -0.0030012079466272138, 0.0005136884367631365, 0.0007594085124526856, 0.0012265140567408422, 0.0006713624614172884, 0.0011351681417927177, 0.0001863642827092013, 0.0008261548723639696, 0.00036483588769965037, 0.0008629052302828452, 0.000887697821599486, 0.0006054313485848456, 0.0007710792438142267, 0.0008909309262240672, 0.0007265529115155398, 0.00021547772473077477, 0.0010690507784152257, 0.00053564075009541, 0.0007784689503650597, 0.0001277771818058878, 0.0009712725602370191, 0.00035252202362234846, 0.0009829821555198599, 0.0006770582226489444, 0.0011663703195318993, 0.000663000002961655, 0.00047623725922337504, 0.0009850225458533119, 0.0007552021280697162, 0.0009471333545424019, 0.0009345272095599026, 0.0008271250839384578, 0.000944300914203519, -0.004289857418477076, 0.0011040471478475631, 0.0003118956420071805, 0.0009702965448889052, 0.0007513997092657825, 0.0007918564045969594, 0.0006947508154909426, 0.0008699509407258503, 0.0007147314601423151, 0.0009197899130134361, 0.0008701661701293409, 0.0006336521588755732, 0.0006241807461236411, 7.189708698119256e-05, 0.0008194862225360396, 0.0008272332334466467, 0.0005188317345248273, 0.0007089351315808296, 0.0007501943123056965, 0.0012396047365153227, 0.0007551573674038473, 0.0009040414327796316, 0.00061421392563337, 0.0005941064275093506, 0.000834088096954076, 0.0007936706982606598, 0.0008807884286864949, 0.0003984647349569562, 0.0011345529395316069, 0.0008438606543937631, 0.0007896011116828186, -0.00017793916787978858, 0.000597421133628545, 0.0008517706829464099, 0.0008327418737183181, 0.0010120591292067341, 0.0006491465844926936, 0.0008162383809745991, 0.0011361668847553424, 0.0008273476458405053, 0.0006757580557227909, 0.0006061294525888498, 0.0008869299852279237, 0.0007629878192779163, 0.000916831831254916, 0.0007931142267202813, 0.0011154382257025737, 0.0010013620249965844, 0.00094870993417483, 0.0011232897619369432, 0.0009219428802127892, 0.00059241540965409, 0.0009160501590072826, 0.0008069052911790304, 0.0006152060259619743, 0.0008752012815160838, 0.0009597802197363934, 0.0008330984572668555, 0.0009485066802265039, 0.0006555867121880417, 0.0008033365694906485, 0.0007653138887702432, 0.00035485077093929453, 0.0006855202722225463, 0.0008412207690707588, 0.0010510860101036355, 0.0007982768930327777, 0.0009454912064661929, 0.0008143161762151981, 0.0004720814846808214, 0.0008989376785110714, 0.0009487424450645569, 0.0007399373587079878, 0.001187875614811461, 0.0007082837375073852, 0.0006361477951563951, 0.0007790697811204528, 0.0009137173476249582, 0.0006850589066180933, 0.0006377585413990482, 0.0005937824435917559, 0.00034464270343375914, 0.0007096495686362807, 0.0005092659553719774, 0.0007328095747953078, 0.0003954466504532918, 0.0009900564747613591, 0.0008370278808081251, 0.0009098347210160477, 0.0006147807448903584, 0.0008907272911136446, 0.0007835028020531631, 0.0005452804309227792, 0.000629812111257818, 0.000799393750753273, 0.0009150894710026674, 0.001042134554659531, 0.0007612566529836339, 0.0004259550354561034, 0.0009346453992967272, 0.0005995778431237947, 0.0006257416294909442, 0.0007741337326128614, 0.0009321388812440181, 0.0007847133806639748, 0.0005107220400787032, 0.000945162071036063, 0.0008053638462201899, 0.0007435490521913897, 0.0008949926359399689, 0.0007113443019384957, 0.0007114221073679866, 0.0005510246260695463, 0.0008245209244347133, 0.0010113305277768799, 0.0009457938270899128, 0.0007191499724294131, 0.0009063305077972328]
###pso(1000data49)
weight=[0.08171998732606602, 0.028964902342725994, 0.024703266380985692, 0.018721197102964236, 0.01760010802540802, 0.01632679956445192, 0.015190441532973395, 0.015027004364943142, 0.014039202736540685, 0.013462833048123297, 0.012195942815914042, 0.011355464072104486, 0.01103250735596856, 0.010894666856529728, 0.009937066299735639, 0.009381358575305053, 0.00902783227154335, 0.008664709857048949, 0.008426507127628657, 0.008149212109557059, 0.007688706636480871, 0.007559714133825175, 0.0074638381931858445, 0.007350294058765689, 0.007132085778107472, 0.006899349195067364, 0.0067359888998056216, 0.0065456010401913735, 0.006490497325951427, 0.006382008254339521, 0.00624694705715213, 0.00602351717304007, 0.005897257246903901, 0.0057006597663816815, 0.005634553592052381, 0.005533927383057244, 0.005400953312318386, 0.005308225959169917, 0.005267567203160254, 0.005181385054840928, 0.005067885274423718, 0.004930516743982375, 0.004899329595848878, 0.004782613954240081, 0.004648670608697707, 0.004625034790555917, 0.004555408842510265, 0.004462807172776753, 0.004407219058548724, 0.004339284724355971, 0.004228011845190378, 0.004152080070689228, 0.004076261685991794, 0.004048910676424833, 0.0039930094215541966, 0.003958359241212242, 0.003892517024960358, 0.0038282913183461877, 0.003711922348275303, 0.0036766200641794125, 0.0036097312411329427, 0.0035558528262187284, 0.0035416351388448657, 0.0034791050619833474, 0.003444902027975052, 0.0034219597645812273, 0.0033926799706583666, 0.0032874701073719857, 0.003275549769545875, 0.003225934992750388, 0.0031774484209118135, 0.0031740715365807426, 0.003127674563196069, 0.0031136956890504097, 0.003084408464470894, 0.0030317065412280983, 0.002979895374456403, 0.0029635165255005357, 0.0029404444434089176, 0.0029301724780509664, 0.0028857013742852274, 0.002860379625799192, 0.002817762882181765, 0.0027660075222040495, 0.002750979692756368, 0.002714357036564881, 0.0026738428285429327, 0.002654828773373673, 0.00263539717357071, 0.0026315973176992166, 0.0026064988134691103, 0.002592145023498197, 0.0025537862596952143, 0.0025399669700295227, 0.0025181922112207937, 0.0024900429742757066, 0.0024666974290946673, 0.0024325290178346497, 0.0024275921859492028, 0.0023840459216207094, 0.0023700043849447343, 0.0023515336249457864, 0.0023214265988435656, 0.0023019632289336097, 0.0022896440920386622, 0.0022843587741914113, 0.0022524882686967896, 0.0022275104775473383, 0.0022212724076608216, 0.002191729875844102, 0.0021853639524451567, 0.002164658963391898, 0.0021261058599626815, 0.0021168236664835445, 0.0020986477612681773, 0.00208653520770489, 0.00207748116168055, 0.0020612213072405657, 0.0020527722563572935, 0.0020250921054001834, 0.002017400253280275, 0.0020114211686332577, 0.0020029409046774436, 0.0019748440255486634, 0.001965467808024232, 0.001952783557199161, 0.001923702973608966, 0.0019091334933246495, 0.001896690732878674, 0.0018883176017377165, 0.0018780171883559856, 0.0018647869990618398, 0.0018526291802124855, 0.0018236447076317136, 0.0018114212829803634, 0.0018065828035918705, 0.0017950681522880766, 0.0017710663982642145, 0.0017626678677374451, 0.001749276094389127, 0.0017414555554421027, 0.0017283064703581604, 0.0017210248706395525, 0.0017056523544519686, 0.0016877345636465164, 0.001684116732007553, 0.0016765528274021047, 0.0016544693017213248, 0.001647011381389408, 0.001634824634648738, 0.0016264134667439865, 0.0016185648938701516, 0.0016116129623085784, 0.0015911400046539435, 0.0015879730605350424, 0.0015757834788710991, 0.0015626063747708249, 0.001557373531079616, 0.0015442046432117677, 0.0015298104164433819, 0.0015241802597769686, 0.001512639408520433, 0.0015100799754764586, 0.0015077583403644015, 0.001496088544565963, 0.001484705604415705, 0.0014797344210349356, 0.0014684745081484571, 0.0014655691228444153, 0.0014556506393894164, 0.0014440786395762814, 0.0014375008687605943, 0.001429919577258583, 0.0014279372980012994, 0.001416246213410987, 0.0014076935296716579, 0.0013932370967316842, 0.0013823119224774293, 0.0013788755002358218, 0.0013709082107308237, 0.0013656936321671887, 0.001358713324196546, 0.0013469455560247057, 0.0013325504837500678, 0.001324031851479245, 0.0013190045728504744, 0.0013074608596133949, 0.0013027920828853152, 0.0012964780736566478, 0.0012885118718350022, 0.0012809415342777527, 0.001274919103789658, 0.0012730168010149506, 0.0012584769277712207, 0.0012561129857197643, 0.0012523707027448181, 0.0012391454849108115, 0.0012274773993523032, 0.0012204527668177908, 0.0012146681408697223, 0.001212232726985242, 0.0012081656732945963, 0.0011974477797234164, 0.0011810023735235751, 0.0011722162642828307, 0.0011690935807321617, 0.001166364394113161, 0.001159602257157567, 0.0011476363890936074, 0.0011430352295485645, 0.0011294096708021049, 0.0011217777801056478, 0.001119904270900142, 0.0011132286088285756, 0.0011080286388920006, 0.0010967564939657422, 0.0010900765284120692, 0.0010869381327003322, 0.0010834398985741173, 0.001077872671385113, 0.001071689483557128, 0.0010655090017057203, 0.0010595914330857146, 0.0010509014147030535, 0.0010460988023137288, 0.0010400073699884224, 0.0010330385324176436, 0.0010303700116609828, 0.0010223002269232563, 0.0010187430572727088, 0.0010166960482496019, 0.0010080342763824186, 0.001004630927612885, 0.0010005132738183575, 0.000994821106379801, 0.0009863859888274297, 0.0009834887041348227, 0.0009770451845328963, 0.0009734799830256467, 0.0009653347424090881, 0.0009644951571987577, 0.0009581704926962975, 0.0009559100362202884, 0.000950505000850539, 0.0009449892594009748, 0.0009361884198054248, 0.0009338713100763326, 0.0009308635408301109, 0.0009190917377257966, 0.0009132030625602726, 0.0009090692916485872, 0.0009002963005739626, 0.0008911371335674695, 0.0008865790600418557, 0.0008817504347734954, 0.0008800060688444448, 0.0008755303934574444, 0.0008718651082360003, 0.00086678758400448, 0.0008608023045599053, 0.0008581562500739479, 0.0008570448463843521, 0.0008517525102789754, 0.0008468104819388287, 0.0008392886074752653, 0.0008369110858856003, 0.0008305468570515274, 0.0008270334371072819, 0.0008239735010328832, 0.0008228002641020712, 0.0008109059982536898, 0.0008054240581164419, 0.0008012668687423112, 0.0008001794819686275, 0.0007912808014776141, 0.000787356711695456, 0.0007831769957021648, 0.0007806805860326131, 0.0007747435512367314, 0.0007710585021581836, 0.0007656684193896918, 0.0007602412232549445, 0.0007546617569470437, 0.0007527269997467285, 0.0007505577249710851, 0.0007474761495173465, 0.0007398874500599631, 0.0007382296552535257, 0.0007295995126756008, 0.0007254646240368273, 0.0007231621517521314, 0.0007134748104651926, 0.0007091180603096409, 0.000705038327679398, 0.0007040077837761551, 0.0006974335300056682, 0.0006942496478868997, 0.0006873943580101409, 0.0006850173941640033, 0.0006789200549524844, 0.0006760210399406089, 0.0006690601364294741, 0.0006671475702479184, 0.0006609374282511454, 0.0006565719343893416, 0.0006554074206539544, 0.0006505628474991964, 0.0006483820250539087, 0.0006449339829997785, 0.0006420027037547879, 0.0006365454587260783, 0.0006317820231434897, 0.0006262714027017007, 0.0006260675213780636, 0.0006202440595442078, 0.0006171274965658937, 0.0006110218652292919, 0.000606555934921663, 0.0006054869643245939, 0.0006007029187425738, 0.0005942413010073018, 0.0005893953371393137, 0.0005881959143163359, 0.0005821940355231589, 0.0005800842591938898, 0.0005747192662806445, 0.0005694897610634918, 0.0005666416802003879, 0.0005658948681906945, 0.0005633059217489632, 0.0005615248301576631, 0.0005571266479566939, 0.0005528451405496938, 0.0005432354202570767, 0.0005420838533217198, 0.0005387046954122965, 0.0005355247314930203, 0.0005296711547174676, 0.0005249496274012823, 0.0005241062919945555, 0.0005167286047664855, 0.0005162625968216174, 0.0005117481086977892, 0.0005098367477808674, 0.0005017221464433905, 0.0005003926987938924, 0.0004977927562221478, 0.000490384024664274, 0.00048620011578154657, 0.00048576795448861647, 0.0004830340863886406, 0.00048003512211434475, 0.00047028918788993504, 0.00046746727351353214, 0.00046491311220749515, 0.00045949349832850536, 0.0004568935523312326, 0.0004523464248492915, 0.0004488139036537031, 0.00044572221216748466, 0.00044365321746997553, 0.0004399661935560564, 0.0004349868724015049, 0.0004324871429952715, 0.00042802682055506457, 0.0004250923521366575, 0.00042171516911963266, 0.00041973810991060727, 0.00041366270742289996, 0.0004077101982690396, 0.00040572271948886043, 0.0004008260711025645, 0.0003936282818807929, 0.0003935020183106673, 0.0003897339632624065, 0.0003885911219240908, 0.0003847653045085078, 0.00038413625169927246, 0.0003807086017723397, 0.000377468907828852, 0.0003671771898110354, 0.0003653387493501665, 0.0003614934728412934, 0.00035873200495836836, 0.0003555791737976539, 0.0003519962396427108, 0.0003491374639627021, 0.00034745728599495137, 0.00034576186105687764, 0.00034242740726908734, 0.0003377750575291563, 0.00033039565037989695, 0.000328842177187706, 0.0003267842266200205, 0.0003196427407583917, 0.00031630912776169545, 0.00031574238265773133, 0.0003109936537813559, 0.0003062226849345067, 0.0003041807033059039, 0.0003030468812393197, 0.00029920774926247824, 0.00029677167912058955, 0.00029258155245215394, 0.00028916087690779665, 0.0002851060833252233, 0.0002800527022498492, 0.00027864228829186733, 0.0002776359652180883, 0.0002670868568674419, 0.0002665629064933458, 0.0002651173758831926, 0.00026202244033657633, 0.00026016625394140343, 0.00025444739653917485, 0.0002500773327749303, 0.00024744760104352575, 0.0002439703876886343, 0.0002418230758472016, 0.00023593549875153941, 0.0002344941826970112, 0.00023324820124418337, 0.00023136745961241454, 0.00022862593257206844, 0.00022761282658045103, 0.00022301202901566975, 0.0002209114601126173, 0.00021967826817417658, 0.00021641803070148352, 0.0002122513834911903, 0.00020969589828020494, 0.00020812325304750594, 0.00020626144347800568, 0.00020082679292995708, 0.00019816034078041508, 0.00019631880900491217, 0.00019087446951045808, 0.00018991351982014659, 0.00018552219702008135, 0.00018162073901794988, 0.00017956421850630133, 0.00017513169147194015, 0.0001730973405024895, 0.0001676035892855801, 0.0001661013425228906, 0.0001640064022414326, 0.00016175247794635128, 0.00015784025825744838, 0.00015597236240811758, 0.00015432046855526056, 0.0001525190048270461, 0.0001485934281504023, 0.00014579851327916132, 0.00014378726721095013, 0.00014026933688770956, 0.0001353414417418907, 0.00013276229584303136, 0.00013116210369262677, 0.00012839023997513773, 0.0001245861791789778, 0.0001236265359331524, 0.00011890048971508987, 0.00011757099629019235, 0.0001144665679562061, 0.00011302010465584807, 0.00011006094351891735, 0.00010604436166729571, 0.00010467853484337822, 0.00010263166238577587, 0.00010049219239905662, 9.638990845330885e-05, 9.355665971651595e-05, 8.963032826990161e-05, 8.601483568349053e-05, 8.276555881819239e-05, 8.145183923719451e-05, 8.055174023700344e-05, 7.697877690739685e-05, 7.482516584655429e-05, 7.194807080998728e-05, 7.110064308329554e-05, 6.937364557715109e-05, 6.705595080534463e-05, 6.551111584495474e-05, 6.067102955247648e-05, 5.817204906224486e-05, 5.5924349821071337e-05, 5.4545741399728116e-05, 4.8207065978073104e-05, 4.666162223421843e-05, 4.6629597407971586e-05, 4.4590784852384044e-05, 4.4196379607910185e-05, 4.019291743222119e-05, 3.857569263745955e-05, 3.677170018102358e-05, 3.5503149881220684e-05, 3.317948727193703e-05, 3.052721231554678e-05, 2.8488799357805092e-05, 2.6482295502897534e-05, 2.444970787838928e-05, 2.355114463673181e-05, 2.1669344140391848e-05, 2.007185824286257e-05, 1.6534913032974947e-05, 1.4610822595700216e-05, 1.0789688470769372e-05, 1.0333024334925143e-05, 1.0113464862015797e-05, 7.886211286575542e-06, 7.602396986577416e-06, 5.58157711825849e-06, 5.10788003058705e-06, 3.970240784564395e-06, 2.3202961198416344e-06, 1.9735064974029234e-06, 1.4421317577341946e-06, 1.1004286891526968e-06, 7.362336990689927e-07, 6.239345542089105e-07, 1.672444165612588e-07, 2.807707518282716e-09, 3.640491375211175e-17, 1.3801675380995893e-17, 1.2342360626962282e-17, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 6.28809504820876e-18, 5.238292856392967e-18, 4.16958632330396e-18, 4.144070043425182e-18]
def Hbeta(D=np.array([]), beta=1.0):
    """
        Compute the perplexity and the P-row for a specific value of the
        precision of a Gaussian distribution.
    """

    # Compute P-row and corresponding perplexity
    # print(D)
    P = np.exp(-D.copy() * beta)
    sumP = sum(P)
    H = np.log(sumP) + beta * np.sum(D * P) / sumP
    P = P / sumP
    return H, P


def x2p(X=np.array([]), tol=1e-5, perplexity=20.0):
    """
        Performs a binary search to get P-values in such a way that each
        conditional Gaussian has the same perplexity.
    """

    # Initialize some variables
    print("Computing pairwise distances...")
    (n, d) = X.shape

    # sum_X = np.sum(np.square(X), 1)
    # D = np.add(np.add(-2 * np.dot(X, X.T), sum_X).T, sum_X)

    y = np.square(X) * weight
    sum_x = np.sum(y, 1)
    D = np.add(np.add(-2 * np.dot(X * weight, X.T), sum_x).T, sum_x)
    P = np.zeros((n, n))
    beta = np.ones((n, 1))
    logU = np.log(perplexity)

    # Loop over all datapoints
    for i in range(n):

        # Print progress
        if i % 500 == 0:
            print("Computing P-values for point %d of %d..." % (i, n))

        # Compute the Gaussian kernel and entropy for the current precision
        betamin = -np.inf
        betamax = np.inf
        Di = D[i, np.concatenate((np.r_[0:i], np.r_[i+1:n]))]
        (H, thisP) = Hbeta(Di, beta[i])

        # Evaluate whether the perplexity is within tolerance
        Hdiff = H - logU
        tries = 0
        while np.abs(Hdiff) > tol and tries < 50:

            # If not, increase or decrease precision
            if Hdiff > 0:
                betamin = beta[i].copy()
                if betamax == np.inf or betamax == -np.inf:
                    beta[i] = beta[i] * 2.
                else:
                    beta[i] = (beta[i] + betamax) / 2.
            else:
                betamax = beta[i].copy()
                if betamin == np.inf or betamin == -np.inf:
                    beta[i] = beta[i] / 2.
                else:
                    beta[i] = (beta[i] + betamin) / 2.

            # Recompute the values
            (H, thisP) = Hbeta(Di, beta[i])
            Hdiff = H - logU
            tries += 1

        # Set the final row of P
        P[i, np.concatenate((np.r_[0:i], np.r_[i+1:n]))] = thisP

    # Return final P-matrix
    print("Mean value of sigma: %f" % np.mean(np.sqrt(1 / beta)))
    return P


def pca(X=np.array([]), no_dims=50):
    """
        Runs PCA on the NxD array X in order to reduce its dimensionality to
        no_dims dimensions.
    """

    print("Preprocessing the data using PCA...")
    (n, d) = X.shape
    X = X - np.tile(np.mean(X, 0), (n, 1))
    (l, M) = np.linalg.eig(np.dot(X.T, X))
    Y = np.dot(X, M[:, 0:no_dims])
    return Y


def tsne(X=np.array([]), no_dims=2, initial_dims=50, perplexity=20.0):
    """
        Runs t-SNE on the dataset in the NxD array X to reduce its
        dimensionality to no_dims dimensions. The syntaxis of the function is
        `Y = tsne.tsne(X, no_dims, perplexity), where X is an NxD NumPy array.
    """

    # Check inputs
    if isinstance(no_dims, float):
        print("Error: array X should have type float.")
        return -1
    if round(no_dims) != no_dims:
        print("Error: number of dimensions should be an integer.")
        return -1

    # Initialize variables
    # X = pca(X, initial_dims).real
    (n, d) = X.shape
    max_iter = 500
    initial_momentum = 0.5
    final_momentum = 0.8
    eta = 100
    min_gain = 0.01

    np.random.seed(2)

    Y = np.random.randn(n, no_dims)
    dY = np.zeros((n, no_dims))
    iY = np.zeros((n, no_dims))
    gains = np.ones((n, no_dims))

    # Compute P-values
    P = x2p(X, 1e-5, perplexity)
    P = P + np.transpose(P)
    P = P / np.sum(P)
    P = P * 4.									# early exaggeration
    P = np.maximum(P, 1e-12)

    # Run iterations
    for iter in range(max_iter):

        # Compute pairwise affinities
        sum_Y = np.sum(np.square(Y), 1)
        num = -2. * np.dot(Y, Y.T)
        num = 1. / (1. + np.add(np.add(num, sum_Y).T, sum_Y))
        num[range(n), range(n)] = 0.
        Q = num / np.sum(num)
        Q = np.maximum(Q, 1e-12)

        # Compute gradient
        PQ = P - Q
        for i in range(n):
            dY[i, :] = np.sum(np.tile(PQ[:, i] * num[:, i], (no_dims, 1)).T * (Y[i, :] - Y), 0)

        # Perform the update
        if iter < 20:
            momentum = initial_momentum
        else:
            momentum = final_momentum
        gains = (gains + 0.2) * ((dY > 0.) != (iY > 0.)) + \
                (gains * 0.8) * ((dY > 0.) == (iY > 0.))
        gains[gains < min_gain] = min_gain
        iY = momentum * iY - eta * (gains * dY)
        Y = Y + iY
        Y = Y - np.tile(np.mean(Y, 0), (n, 1))

        # Compute current value of cost function
        if (iter + 1) % 10 == 0:
            if iter > 100:
                C = np.sum(P * np.log(P / Q))
            else:
                C = np.sum(P / 4 * np.log(P / 4 / Q))
            # C = np.sum(P * np.log(P / Q))
            print("Iteration %d: error is %f" % (iter + 1, C))

        # Stop lying about P-values
        if iter == 100:
            P = P / 4.
    np.savetxt(r'MQ.text', Q, delimiter=',')
    # Return solution
    return Y

if __name__ == "__main__":
    # data = pd.read_csv('../mnist_data.csv')
    # type = pd.read_csv('../mnist_type.csv')
    # data_zip=pd.concat([data,type.iloc[:,1:]],axis=1)
    # data_filter=data_zip[(data_zip['class'].isin([4,9]))]
    # data_filter=data_filter.sample(n=1000)
    # # print(data_filter.shape)
    # # data_filter = data_filter[:13000]
    # data_filter.to_csv('mnist_data49(1000)2.csv',index=False)

    data_zip=pd.read_csv('mnist_data49.csv')
    n,m=data_zip.shape
    label=data_zip.iloc[:,m-1:]
    data=data_zip.iloc[:,1:m-1]
    X = np.array(data)
    label=np.array(label)
    # #
    for i in range(len(X)):
        for j in range(len(X[i])):
            if X[i][j]!=0:
                X[i][j]=int(1)
            else:
                X[i][j] = int(0)
    data = tsne(X, 2, 50, 30.0)

    data4=[]
    data9=[]
    # data7 = []
    for i in range(0,len(label)):
        if label[i] == 4:
            data4.append(data[i])
        if label[i] == 9:
            data9.append(data[i])
        # if label[i] == 7:
        #     data7.append(data[i])
    data4 = np.array(data4)
    data9 = np.array(data9)
    # data7 = np.array(data7)
    fig=plt.figure(1)
    ax=plt.subplot(111)
    type1=ax.scatter(data4[:,0],data4[:,1],c='yellow')
    type2=ax.scatter(data9[:, 0], data9[:, 1], c='brown')
    # type3 = ax.scatter(data7[:, 0], data7[:, 1], c='blue')
    ax.legend((type1,type2),('4','9'))
    # plt.title("Weight_t-SNE_2000")
    plt.show()
    X_train, X_test, y_train, y_test = train_test_split(data, label, test_size=0.9, random_state=0)
    print(X_train.shape, X_test.shape)


    y_train=y_train.ravel()
    y_test=y_test.ravel()

    gnb = GaussianNB().fit(X_train, y_train)
    y_pred = gnb.predict(X_test)

    cm = confusion_matrix(y_true=y_test, y_pred=y_pred)
    print(cm)
    # print(y_test)
    # print(y_pred)
    print(recall_score(y_true=y_test, y_pred=y_pred, average=None))
    print(precision_score(y_true=y_test, y_pred=y_pred, average=None))
    # print(f1_score(y_true=y_test, y_pred=y_pred, average='macro'))

